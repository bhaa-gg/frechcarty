@if (loading) {
<Eco-loading />
}

@if (!API_ERROR) {
<section class="space-y-8 min-h-[80vh]">
  <div class="grid gap-8 grid-cols-1 lg:grid-cols-5">

    <!-- Images -->
    <div class="col-span-2 border border-primary-400 rounded-2xl dark:border-gray-700">
      <owl-carousel-o [options]="customOptions">
        @for (img of this.theProductImgs; track img; let i = $index) {
        <ng-template carouselSlide [dataDot]="getDotImage(img)">
          <img [src]="img" class="w-full h-[600px] rounded-2xl object-cover" alt="Product Image">
        </ng-template>
        }
      </owl-carousel-o>
    </div>

    <!-- Details -->
    <div class="col-span-3 flex items-center justify-center">
      <div class="space-y-4 w-full relative rounded-2xl p-6 shadow-2xl bg-white dark:bg-gray-900 transition-colors">

        <!-- Wishlist -->
        <div class="absolute top-4 right-4">
          <Eco-add-to-which-list (addToWichListFire_1)="addToWishlist(this.theProduct?.id||'')"
            (deleteFromWichListFire_1)="delFromWishlist(this.theProduct?.id||'')" [loadingBtnWish]="loadingBtnWish"
            [inWish]="inWish" />
        </div>

        <!-- Title -->
        <h2 class="text-2xl font-semibold text-gray-800 dark:text-gray-100">
          {{this.theProduct?.title}}
        </h2>

        <!-- Description -->
        <p class="p-2 text-sm text-gray-500 dark:text-gray-400 font-bold">
          {{this.theProduct?.description}}
        </p>

        <!-- Category -->
        <p class="text-primary-600 dark:text-primary-400 font-bold">
          {{this.theProduct?.category?.name}}
        </p>

        <!-- Price + Rating -->
        <div class="flex items-center justify-between">
          <p class="text-gray-700 dark:text-gray-300 text-sm font-semibold">
            {{theProduct?.price | currency : 'Egp'}}
          </p>
          <p class="text-gray-700 dark:text-gray-300 text-sm font-semibold flex items-center gap-1">
            <i class="fa-solid fa-star text-amber-400"></i>
            {{theProduct?.ratingsAverage}}
          </p>
        </div>

        <!-- Add to Cart -->
        <Eco-add-to-cart-btn [btnLoading]="loadingBtn" [inCart]="inCart"
          (deleteFromCart_1)="removeProductFromCart(this.theProduct?.id||'')"
          (addToCartFire_1)="addToCart(this.theProduct?.id||'')" [productId]="this.theProduct?.id+''" />
      </div>
    </div>
  </div>

  <!-- Divider -->
  <div #relate class="h-[1px] w-full bg-gray-300 dark:bg-gray-700"></div>

  <!-- Related Products -->
  @defer (on viewport(relate)) {
  <Eco-relate-products [Title]="'Relate Products'" [Products]="theRelatedProducts" />
  }
  @placeholder {
  <div class="flex items-center justify-center text-gray-500 dark:text-gray-400">
    loading...
  </div>
  }
</section>
}@else{
<div class="flex w-full text-6xl text-red-800 dark:text-red-500 items-center justify-center">
  API Error
</div>
}